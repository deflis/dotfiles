# oh-my-posh --init --shell pwsh --config "$(scoop prefix oh-my-posh)/themes/night-owl.omp.json" | Invoke-Expression
# oh-my-posh --init --shell pwsh --config "~/.config/powershell/theme.yaml" | Invoke-Expression
{{ output "oh-my-posh" "init" "pwsh" "--config=~/.config/powershell/theme.yaml" }}

Import-Module posh-git
Import-Module PSFzf
$env:POSH_GIT_ENABLED = $true

# タブ補完のやり方を変更
Set-PSReadLineKeyHandler -Key Tab -Function Complete

$env:EDITOR = "code --wait"
$env:FZF_DEFAULT_OPTS = "--height 40% --layout=reverse"

# 今すぐalias登録すべきPowerShellワンライナー
# https://qiita.com/mu_sette/items/3954759daee8ae9ad26f
function CustomListChildItems { Get-ChildItem $args[0] -force | Sort-Object -Property @{ Expression = 'LastWriteTime'; Descending = $true }, @{ Expression = 'Name'; Ascending = $true } | Format-Table -AutoSize -Property Mode, Length, LastWriteTime, Name }
Set-Alias ll CustomListChildItems

{{ output "chezmoi" "completion" "powershell" }}
{{ output "zoxide" "init" "--hook" "pwd" "powershell" }}
{{ output "fnm" "env" "--use-on-cd" "--shell" "powershell" }}

Set-Alias -Name cd -Value z -Option AllScope -Scope Global -Force
Set-Alias -Name cdi -Value zi -Option AllScope -Scope Global -Force

Set-PsFzfOption -PSReadlineChordReverseHistory 'Ctrl+r'

function cdr {
    cd $(ghq list -p | fzf)
}

# https://qiita.com/mizutoki79/items/372e1f21548e926f76e0
function which ($command) {
    Get-command -Name $command -ShowCommandInfo | Format-List -Property Definition
}

Set-PSReadlineOption -Color @{
    "Command" = [ConsoleColor]::Green
    "Parameter" = [ConsoleColor]::Gray
    "Operator" = [ConsoleColor]::Magenta
    "Variable" = [ConsoleColor]::White
    "String" = [ConsoleColor]::Yellow
    "Number" = [ConsoleColor]::Blue
    "Type" = [ConsoleColor]::Cyan
    "Comment" = [ConsoleColor]::DarkCyan
}
